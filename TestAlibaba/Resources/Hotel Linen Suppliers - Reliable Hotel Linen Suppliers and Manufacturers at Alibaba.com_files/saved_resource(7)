(function(){var e=function(){var e={},t={exports:e};"use strict";var r=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=function(){var e="icbu-messenger",t="postMessage"in window;function n(e,t){var n="";if(arguments.length<2){n="target error - target and name are both required"}else if((typeof e==="undefined"?"undefined":r(e))!="object"){n="target error - target itself must be window object"}else if(typeof t!="string"){n="target error - target name must be string type"}if(n){throw new Error(n)}this.target=e;this.name=t}if(t){n.prototype.send=function(t){this.target.postMessage(e+t,"*")}}else{n.prototype.send=function(t){var r=window.navigator[e+this.name];if(typeof r=="function"){r(e+t,window)}else{throw new Error("target callback function is not defined")}}}function a(t,r){this.targets={};this.name=t;this.listenFunc=[];e=r||e;this.initListen()}a.prototype.addTarget=function(e,t){var r=new n(e,t);this.targets[t]=r};a.prototype.initListen=function(){var n=this;var a=function o(t){if((typeof t==="undefined"?"undefined":r(t))=="object"&&t.data){t=t.data}if(typeof t==="string"&&t.indexOf(e)!=-1){t=t.slice(e.length);for(var a=0;a<n.listenFunc.length;a++){n.listenFunc[a](t)}}};if(t){if("addEventListener"in document){window.addEventListener("message",a,false)}else if("attachEvent"in document){window.attachEvent("onmessage",a)}}else{window.navigator[e+this.name]=a}};a.prototype.listen=a.prototype.on=function(e){this.listenFunc.push(e)};a.prototype.clear=function(){this.listenFunc=[]};a.prototype.send=function(e){var t=this.targets,r;for(r in t){if(t.hasOwnProperty(r)){t[r].send(e)}}};return a}();return t.exports}();var t=function(){var t={},r={exports:t};"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=e;var a=o(n);function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){if(e.addEventListener){e.addEventListener(t,r,false)}else if(e.attachEvent){e.attachEvent("on"+t,r)}}var u="//is.alicdn.com/js/6v/biz/common/store-proxy/store-proxy2.html?iframe_delete=true";var f="-_-";var s="T_T";if(typeof window.__StoreProxyReady3=="undefined"){window.__StoreProxyReady3=false}var c=window.__StoreProxyReady3;if(typeof window.__StoreProxyExec3=="undefined"){window.__StoreProxyExec3=[]}var d=window.__StoreProxyExec3;function l(e){var t="localstorage-proxy-ifr-alibabadotcom3";var r=document.getElementById(t);if(r){c=window.__StoreProxyReady3;if(!c){d.push(e)}else{console.log(1111);e(r)}return}if(u.indexOf("iframe_delete")===-1){u+=u.indexOf("?")>-1?"&":"?";u+="iframe_delete=true"}r=document.createElement("iframe");r.id=t;r.src=u;r.style.display="none";r.style.visibility="hidden";var n;n=setInterval(function(){if(r&&r.contentWindow&&r.Messenger){for(var e=0,t=d.length;e<t;e++){d[e](r)}d.length=0;window.__StoreProxyReady3=c=true;clearInterval(n);n=0}},50);i(r,"load",function(){if(n){clearInterval(n);n=0}if(window.__StoreProxyReady3){c=true;return}for(var e=0,t=d.length;e<t;e++){d[e](r)}d.length=0;window.__StoreProxyReady3=c=true});d.push(e);document.body.appendChild(r)}var v;var p={};var m=0;function g(e){e=e||function(){};if(v){e(v);return}l(function(t){if(v){e(v);return}v=new a["default"]("parent","store-proxy");v.addTarget(t.contentWindow,"proxy");v.listen(function(e){y(e)});e(v)})}function h(e,t,r,n){var a=[e,t,r];if(e!="set"){n=r;a.pop();a.push(m++)}a=a.join(f);p[a]=n;return a}function y(e){var t,r;var n=e.split(s);e=n[0];t=n[1]||null;r=n[2]||undefined;if(p[e]){p[e](t,r)}}t["default"]={get:function b(e){var t,r;if(arguments.length>1){if(w(arguments[arguments.length-1])){r=arguments[arguments.length-1]}if(arguments[1]!==r){t=arguments[1]}}g(function(n){n.targets["proxy"].send(h("get",e,function(e,n){if(!e&&t&&t.filter){n=t.filter(n)}r(e,n)}))})},set:function x(e,t){var r,n;if(arguments.length>2){if(w(arguments[arguments.length-1])){n=arguments[arguments.length-1]}if(arguments[2]!==n){r=arguments[2]}}if(r&&r.filter){t=r.filter(t)}if(!_(t)){throw new Error('value must be String in "storeProxy2.set"!')}g(function(r){r.targets["proxy"].send(h("set",e,t,n))})},remove:function S(e,t){g(function(r){r.targets["proxy"].send(h("remove",e,t))})}};function w(e){return Object.prototype.toString.call(e)==="[object Function]"}function _(e){return Object.prototype.toString.call(e)==="[object String]"}r.exports=t["default"];return r.exports}();var r=function(){var e={},r={exports:e};r.exports=t;return r.exports}();var n=function(){var e={},t={exports:e};"use strict";Object.defineProperty(e,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var a=r;var o=i(a);function i(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=function(){function e(t){u(this,e);this.config={prefix:"alibaba"};n(this.config,t);this.prefix=this.config.prefix}e.prototype.get=function t(e){var t=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{expires:0};return new Promise(function(n,a){var i=r.expires;o["default"].get(t.prefix+"."+e,function(e,t){if(e){a(e)}else{try{var r={};if(t){try{r=JSON.parse(t);var o=r,u=o.created,f=o.keeptTime;if(u&&f&&Date.now()-u>=f){n()}else if(i&&i<Date.now()){n()}else{n(r.payLoad)}}catch(s){a(s);return}}else{n(t)}}catch(s){a(s)}}})})};e.prototype.set=function r(e,t){var r=this;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var a=n.keeptTime,i=a===undefined?0:a;var u={created:Date.now(),keeptTime:i,payLoad:t};return new Promise(function(n,a){o["default"].set(r.prefix+"."+e,JSON.stringify(u),function(e){if(e){a(e)}else{n(t)}})})};e.prototype.remove=function a(e){var t=this;return new Promise(function(r,n){o["default"].remove(t.prefix+"."+e,function(e){if(e){n(e)}else{r(true)}})})};return e}();var s=new f({prefix:"big-brother"});var c={common:27126,performance:27122,api:27123};var d={counter:null,spm:null,version:13};var l={timeout:1};var v=function k(e,t){if(!e)return;var r=new RegExp("[?&]"+t+"=(([^&#]*)|&|#|$)","i");var n=e.match(r);return n&&n.length>1?n[1]:undefined};var p=function R(){};var m=function T(){var e=g("data-spm");var t=document.body&&document.body.getAttribute("data-spm");return e&&t&&e+"."+t};function g(e){var t=document.querySelector('meta[name="'+e+'"]');if(!t)return;return t.getAttribute("content")}var h=function I(e){if(!e)return new Promise(function(e){return e(-2)});var t="bb_fingerprint";var r="bb_counter_"+e;return O(t).then(function(e){if(!e){return P(t).then(function(){return-9})}return O(r,E(7)).then(function(e){if(e){return 1}return 0})}).then(function(e){P(r,1);return e})};var y=function N(e,t){t=_(t);if(window.__BB&&window.__BB.send){window.__BB.send(e,t);return}var r=(window.dmtrack||{}).dotstat;r&&r(e,{ext:t})};var w=function D(e){return/alicdn\.com/.test(e)};function _(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"|";var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"=";if(t===false)return e;var a=[];for(var o in e){var i=e[o];if(i===undefined)continue;a.push(""+o+n+i)}return a.join(r)}var b=function A(e){return parseInt(e>12e4||e<-12e4?0:e)};var x=function L(e,t){if(S(e))t()};function S(e){return Math.random()*100<e}function P(e,t){try{var r=JSON.stringify({value:t,time:Date.now().valueOf()});return s.set(e,r)}catch(n){return new Promise(function(e){return e()})}}function O(e,t){return s.get(e).then(function(r){if(r===undefined||!t)return r;var n=JSON.parse(r);var a=n.time,o=n.value;var i=Date.now().valueOf()-a;if(i<=t)return o;return s.remove(e)})}function E(e){return e*24*60*60*1e3}var C=function V(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var r=window.__BB||{};var n=r[e];if(n!==undefined)return n;if(t)return g("bb-"+e)};var M=function H(){var e=parseInt(C("mode"));return isNaN(e)?0:e};var j=function z(){return C("spm")||m()};var B=function F(e){return new Promise(function(t,r){if(e>=10){t(true);return true}if([1,2,3,4,5].indexOf(e)<0){r("Rate Errot");return}var n="bb_simple_bucket_"+e;s.get(n).then(function(t){if(t!=undefined)return!!~~t;t=~~(Math.random()*10<=e);return s.set(n,t).then(function(){return!!~~t})}).then(function(e){t(e)})})};e["default"]={store:s,StoreProxy:f,extractParam:v,hitBucketA:B,extractSpm:m,getConfig:C,isResource:w,getMode:M,getSpm:j,days2ms:E,readMark:O,writeMark:P,CID:c,CACHE:d,ERR:l,initial:p,matchRate:S,chance:x,filterValue:b,objectToParam:_,visitCounter:h,send:y};t.exports=e["default"];return t.exports}();var a=function(){var e={},t={exports:e};"use strict";Object.defineProperty(e,"__esModule",{value:true});var r=n;var a=o(r);function o(e){return e&&e.__esModule?e:{"default":e}}var i=function s(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Number.MAX_VALUE;var r=u();if(!r.getEntries)return;var n=r.getEntries()||[];if(!n.length)return;for(var a=0;a<Math.min(n.length,t);a++){var o=n[a];e&&e(o)}};function u(){return window.performance||window.webkitPerformance||window.msPerformance||window.mozPerformance||{}}var f=function c(e){var t=u();var r=t.timing;if(!r)return;return{dns:a["default"].filterValue(r.domainLookupEnd-r.domainLookupStart),tcp:a["default"].filterValue(r.connectEnd-r.connectStart),ttfb:a["default"].filterValue(r.responseStart-r.requestStart),html:a["default"].filterValue(r.domContentLoadedEventEnd-r.navigationStart),download:a["default"].filterValue(r.responseEnd-r.responseStart),load:a["default"].filterValue(r.loadEventEnd-r.navigationStart),exposed:e?a["default"].filterValue(e-r.navigationStart):undefined}};e["default"]={analysis:f,getPerformance:u,eachEntity:i};t.exports=e["default"];return t.exports}();var o=function(){var e={},t={exports:e};"use strict";Object.defineProperty(e,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var o=n;var i=s(o);var u=a;var f=s(u);function s(e){return e&&e.__esModule?e:{"default":e}}var c=function g(e,t){var r=e/1024/t*1e3;return isNaN(r)?0:parseInt(r)};var d=function h(e){return e(0)};var l=function y(e){var t=0,r=0;var n={};f["default"].eachEntity(function(e){var a=e.responseEnd,o=e.connectStart,u=e.name,f=e.transferSize;var s=a-o;var c=f||0;if(c<=0||s<=0)return;var d=u.replace(/^(https?:\/\/)(.+?)\/(.+)?$/,"$2");if(d&&i["default"].isResource(u)){if(!n[d]){n[d]={size:c,duration:s}}else{n[d].size+=c;n[d].duration+=s}}t+=c;r+=s},e);var a={avg:0};if(r===0||t===0){return a}a.avg=c(t,r);for(var o in n){a[o]=c(n[o].size,n[o].duration)}return a};var v=function w(e,t){var n=f["default"].analysis();var a={type:"speed",tcp:n.tcp,dns:n.dns,html:n.html,load:n.load,v:i["default"].CACHE.version,d_speed:e};r(a,t);i["default"].send(i["default"].CID.common,a)};var p=function _(e){window.setTimeout(function(){d(function(t){var n=l();var a=r({},e.extend,{delay:e.delay,source:e.source,p_speed:i["default"].objectToParam(n,true,";","^")});v(t,a)},e.source)},e.delay)};var m=function b(e){var t=r({source:"gw",rate:100,delay:3e3},e);i["default"].chance(t.rate,function(){p(t)})};e["default"]={report:m,detectWithPerformance:l,detectWithFile:d};t.exports=e["default"];return t.exports}();var i=function(){var e={},t={exports:e};"use strict";Object.defineProperty(e,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var a=n;var o=i(a);function i(e){return e&&e.__esModule?e:{"default":e}}var u=function l(e){if(!window.fetch)return false;if(typeof e==="string")e=[e];for(var t=0;t<e.length;t++){window.fetch(e[t])}return true};var f=function v(e){return"bb_preload_"+e};var s=function p(e,t){var r=o["default"].readMark(f(e),o["default"].days2ms(7));return r&&r.version===t};var c=function m(e){var t=o["default"].extractSpm();for(var r in e){if(r===t)continue;var n=e[r];var a=n.version,i=n.files,s=n.matchSpm;if(s&&s.indexOf(t)<0)continue;if(u(i)){o["default"].writeMark(f(r),{version:a})}}};var d=function g(e){var t=r({rate:10,delay:3e3},e);var n=t.pages,a=t.delay;if(!o["default"].hitBucketA(t.rate))return;window.setTimeout(function(){c(n)},a)};e["default"]={isCached:s,execute:d};t.exports=e["default"];return t.exports}();var u=function(){var e={},t={exports:e};"use strict";Object.defineProperty(e,"__esModule",{value:true});var r=function(){function e(e,t){var r=[];var n=true;var a=false;var o=undefined;try{for(var i=e[Symbol.iterator](),u;!(n=(u=i.next()).done);n=true){r.push(u.value);if(t&&r.length===t)break}}catch(f){a=true;o=f}finally{try{if(!n&&i["return"])i["return"]()}finally{if(a)throw o}}return r}return function(t,r){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var f=n;var s=g(f);var c=o;var d=g(c);var l=i;var v=g(l);var p=a;var m=g(p);function g(e){return e&&e.__esModule?e:{"default":e}}var h=false;var y=function S(){var e=0,t=0,r=0,n=0;m["default"].eachEntity(function(a){var o=a.initiatorType,i=a.name,u=a.transferSize,f=a.encodedBodySize;if(!s["default"].isResource(i)||o==="img")return;if(!f||f<=0)return;n++;t+=u;if(u===0){e+=f;r++}});return{cs:parseInt(e/1024),ts:parseInt(t/1024),cf:r,tf:n}};var w=function P(e){var t={};if(!(e instanceof Array))return t;for(var r=0;r<Math.min(e.length,10);r++){var n=parseInt(e[r]);if(isNaN(n))n=0;t["s"+r]=n}return t};var _=function O(){var e=0;var t=function r(){var t=s["default"].getConfig("exposed",false);if(t){x(t);return}if(e++>60){x(null,null,u({reason:s["default"].ERR.timeout,exposed:-1}));return}window.setTimeout(function(){r()},1e3)};t()};var b=function E(){switch(s["default"].getMode()){case-1:_();break;case 1:break;default:x();break}};function x(e,t,n){var a=window.__BB||{};var o=m["default"].analysis(e);if(!o)return;if(o.load===0){window.setTimeout(function(){x(e,t,n)},1e3);return}if(h)return;var i=s["default"].CACHE;var f=s["default"].getSpm();Promise.all([s["default"].visitCounter(f)]).then(function(e){var c=r(e,1),l=c[0];u(o,w(s["default"].getConfig("times",false)||t),{mode:s["default"].getMode(),spm:f,v:i.version,preload:~~v["default"].isCached(f,s["default"].getConfig("cacheVersion",false)),speed:d["default"].detectWithPerformance().avg,group:s["default"].getConfig("group"),stat_mode:s["default"].getConfig("stat_mode"),visit:l},n,y());var p=m["default"].getPerformance().timing;if(p){["click","keydown","touchstart","scroll"].forEach(function(e){var t=a[e]-p.navigationStart;if(!isNaN(t))o[e]=t})}if(a.extendParams){for(var g in a.extendParams){o["c_"+g]=a.extendParams[g]}}h=true;s["default"].send(s["default"].CID.performance,o)})}e["default"]={autoReport:b,report:x};t.exports=e["default"];return t.exports}();var f=function(){var e={},t={exports:e};"use strict";Object.defineProperty(e,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var a=n;var o=i(a);function i(e){return e&&e.__esModule?e:{"default":e}}var u=function h(e,t,n,a){var i=r({v:o["default"].CACHE.version,spm:o["default"].getSpm(),name:t,duration:e,group:o["default"].getConfig("group"),stat_mode:o["default"].getConfig("stat_mode"),status:n},a);o["default"].send(o["default"].CID.api,i)};var f=function y(e,t,r){u(e,t,1,r)};var s=function w(e,t,r){u(e,t,0,r)};var c=function _(e){var t=o["default"].extractParam(e,"__bb_name__");if(t)return decodeURIComponent(t);var r=e.match(/^https?:\/\/(.+?)(?=[\?#])/);return r&&r[1]||e};var d=function b(e){var t=e.name,r=e.initiatorType;if(/__bb_name__/.test(t))return true;if(/alicdn\.com/.test(t))return false;if(/callback=/.test(t))return true;if(!r&&!/\.((js)|(png)|(jpe?g)|(webp)|(html?)|(css)|(gif)|(woff))/.test(t))return true;if(r==="xmlhttprequest"&&!/\.js/)return true};var l=function x(e){var t=e.name,r=e.responseStart,n=e.requestStart,a=e.duration;var i=o["default"].filterValue(r-n);var u={ttfb:i};f(o["default"].filterValue(a),c(t),u)};var v=function S(e){var t=/(cmap)|(connectkeyword)\.alibaba\.com/;return/\.alibaba\.com/.test(e)&&!t.test(e)};var p=function P(e,t){var r=e.name;if(!r)return;if(!v(r))return;var n=o["default"].extractParam(r,"__bb_disable__");if(n==="1")return;var a=parseInt(o["default"].extractParam(r,"__bb_rate__"));if(isNaN(a))a=t.rate;if(o["default"].matchRate(a))l(e)};var m=function O(e){var t=new PerformanceObserver(function(t){var r=t.getEntries();for(var n=0;n<r.length;n++){var a=r[n];if(!d(a))continue;p(a,e)}});t.observe({entryTypes:["resource"]})};var g=function E(e){var t=r({rate:10},e);if(!window.PerformanceObserver)return;m(t)};e["default"]={send:u,detectName:c,autoReport:g,error:s,success:f};t.exports=e["default"];return t.exports}();var s=function(){var e={},t={exports:e};"use strict";Object.defineProperty(e,"__esModule",{value:true});e.speed=e.performance=e.api=e.common=undefined;e["default"]=function(){s["default"].initial();return{common:s["default"],api:v["default"],performance:d["default"],speed:a["default"]}};var r=o;var a=p(r);var i=n;var s=p(i);var c=u;var d=p(c);var l=f;var v=p(l);function p(e){return e&&e.__esModule?e:{"default":e}}e.common=s["default"];e.api=v["default"];e.performance=d["default"];e.speed=a["default"];return t.exports}();var c=function(){var e={},t={exports:e};t.exports=s;return t.exports}();var d=function(){var e={},t={exports:e};var r=c;window.SCHD_COMS=window.SCHD_COMS||{};if(!window.SCHD_COMS.BigBrother){var n=r.default();var a=n.common.getSpm();var o=n.common.store;o.get("preload-pages").then(function(e){__BB=typeof __BB==="object"?__BB:{};n.performance.autoReport();n.api.autoReport({rate:30});n.speed.report({rate:30})});window.SCHD_COMS.BigBrother=n}t.exports=window.SCHD_COMS.BigBrother;return t.exports}()})();;
